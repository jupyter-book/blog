---
title: Jupyter Book V3 AST: Better Output Handling and Future Possibilities
date: 2025-12-17
authors:
  - id: stevejpurves
---

We're excited to announce the release of MyST Markdown V3 AST support in Jupyter Book, a significant upgrade that improves how Jupyter notebook outputs are handled and allows for better control over how Jupyter generated content is rendered.

:::{tip} Available in `mystmd` `v0.7.1` and `jb` `2.1.0` or later
As this is a major change to the MyST AST that also requires the latest `myst-theme`s, when upgrading, please clean your project folders:

```
jb clean --all
```

:::

## What Changed?

In previous versions, all outputs from a Jupyter notebook cell were bundled together as a single data structure. While this worked for basic use cases, it limited our ability to handle individual outputs with the flexibility and precision that modern documentation needs.

With the V3 AST upgrade, each output from a code cell is now represented as its own node in the Abstract Syntax Tree. The MyST AST changed from:

```json
{
  "type": "output",
  "id": "cell-output-1",
  "data": [
    // Array of all output data from the cell
    { "output_type": "display_data", "data": {...}, ... },
    { "output_type": "stream", "text": "...", ... },
    // ... more outputs
  ]
}
```

to 

```
{
  "type": "outputs",
  "id": "cell-outputs-1",
  "children": [
    {
      "type": "output",
      "id": "output-1",
      "jupyter_data": { "output_type": "display_data", "data": {...} },
      "children": []
    },
    {
      "type": "output",
      "id": "output-2",
      "jupyter_data": { "output_type": "stream", "text": "..." },
      "children": []
    }
  ]
}
```


## Why This Matters

This change is foundational for several reasons. First, it brings Jupyter outputs into the MyST AST as first-class citizens, rather than treating them as opaque data blobs. This enables outputs to participate in the same document processing pipeline as the rest of your content.

Second, it sets the stage for future enhancements. The new structure allows us to parse and process output content—like Markdown or LaTeX generated by code cells—directly into MyST AST nodes. This means outputs can define and consume reference labels, appear in cross-reference resolution, and integrate seamlessly with the rest of your documentation.

## What's Next?

This upgrade enables:

:::{note} TODO

* We could list on specific PRs/issus that this unblocks
* other forward looking iseas features
* challenges?

:::

## Migrations

If you are a user of `jupyter-book` or `mystmd` CLIs you should not have to worry about the upgrade, your existing content will work[^1] after a **clean** local build. If you are or have developed your own custom "theme" for your books you will have to either; Re-build and deploy your content *or* integrate the `myst-migrate` package's `upgrade` and `downgrade` function into your front-end stack. We recommend the latter, but especially as it will be needed to make full use of MyST Markdown's remote cross referencing features. See [myst-theme](https://github.com/jupyter-book/myst-theme) for how `myst-migrate` is used there.

[^1]: As of today, this was a bumpy release but if you are now upgraded to the latest CLI then this should be transparent to you.

## Learn More & Contribute

For technical details about the AST changes **and** to comment or contribute, see [MEP-0004: Per-Output AST Representation for Code Cell Outputs](https://github.com/jupyter-book/myst-enhancement-proposals/blob/main/meps/mep-0004.md). The upgrade is available now in `mystmd@1.7.0+` and is being rolled out across the Jupyter Book ecosystem.

We're grateful to the community contributors who made this upgrade possible, particularly [@agoose77](https://github.com/agoose77) and [@stevejpurves](https://github.com/stevejpurves) for pushing forward on implementation and to [@agoose77](https://github.com/agoose77) for kicking off the [@rowanc1](https://github.com/rowanc1) [MEP](https://github.com/jupyter-book/myst-enhancement-proposals/pull/32) process.

